<div id="sign-comments">
  <div class="grid-x">
    <div class="cell auto sign-comments--title">
      View comments
    </div>
    <div class="cell auto sign-comments--count">
      showing <%= sign_comment_count(sign) %> of <%= sign_comment_count(sign) %> comments
    </div>
  </div>
  <hr>
  <div class="grid-x">
    <% sign.sign_comments.each do |comment| %>
      <% next unless comment.display %>
      <% comment = present(comment) %>
      <div class="cell shrink sign-comment">
        <%= link_to user_path(comment.user) do %>
          <%= comment.user_avatar %>
        <% end %>
      </div>
      <div class="cell auto sign-comment sign-comment__box">
        <% if comment.video.attached? %>
          <%= video_tag url_for(comment.video), size: "320x240", controls: true %>
        <% end %>
        <span class="cell auto sign-comment--username">
          <%= comment.username %>
        </span>
        <span class="cell auto sign-comment sign-comment--comment">
          <%= comment.html_comment %>
        </span>
      </div>
      <%= render "sign_comments/options", comment: comment %>
      <div class="cell sign-comment sign-comment__reply">
        <span class="cell auto">
          <%= content_tag "a", nil, data: { id: dom_id(comment) }, class: "js-sign-comment-reply sign-comment__reply__link sign-comment__reply__link--text" do %>
            <%= inline_svg "media/images/reply.svg", aria_hidden: true, class: "icon icon--medium" %>
            Reply
          <% end %>
          &nbsp;â€¢&nbsp;
        </span>
        <span class="cell auto">
          <%= comment.friendly_date %>
        </span>
      </div>
      <%= render "sign_comments/reply", comment: comment %>
      <% comment.replies.each do |reply| %>
        <% next unless reply.display %>
        <% reply = present(reply) %>
        <div class="cell shrink sign-comment sign-comment__reply">
          <%= link_to user_path(reply.user) do %>
            <%= reply.user_avatar %>
          <% end if reply.user %>
        </div>
        <div class="cell auto sign-comment sign-comment__box">
          <span class="cell auto sign-comment--username">
            <%= reply.username %>
          </span>
          <span class="cell auto sign-comment sign-comment--comment">
            <%= reply.html_comment %>
          </span>
        </div>
        <div class="cell shrink sign-comment">
          <%= render "sign_comments/options", comment: reply %>
        </div>
        <div class="cell sign-comment sign-comment__reply--created">
          <%= reply.friendly_date %>
        </div>
      <% end %>
    <% end %>
  </div>
  <div class="grid-x">
    <div class="cell shrink sign-comments__contributor">
      <% contributor = present(sign.contributor) %>
      <%= link_to user_path(contributor) do %>
        <%= contributor.avatar("avatar avatar--small") %>
      <% end %>
    </div>
    <%= render "sign_comments/new", sign: sign %>
  </div>
</div>
